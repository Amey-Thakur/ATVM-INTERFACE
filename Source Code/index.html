<!DOCTYPE html>
<html lang="en" ng-app>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MUMBAI RAILWAY | ATVM</title>

    <!-- Premium Assets -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- Core Styles -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/modules/themes.css" rel="stylesheet">
    <link href="css/modules/components.css" rel="stylesheet">
    <link href="css/modules/layout.css" rel="stylesheet">
    <link href="css/modules/map.css" rel="stylesheet">
    <link href="css/atvm.css" rel="stylesheet">
</head>

<body ng-controller="atvmController">
    <!-- Premium Loading Screen -->
    <div class="premium-loader">
        <img src="images/logo.png" style="width: 80px; filter: grayscale(1); opacity: 0.3;">
        <div class="loader-bar">
            <div class="loader-fill"></div>
        </div>
        <p style="font-size: 11px; text-transform: uppercase; letter-spacing: 2px; color: #8e8e93;">Initializing Mumbai
            Rail Network...</p>
    </div>

    <!-- Script to trigger load finish -->
    <script>
        window.addEventListener('load', function () {
            setTimeout(function () {
                document.body.classList.add('loaded');
            }, 1500);
        });
    </script>

    <div class="main-container">
        <!-- Interactive Map Overlay -->
        <div class="map-overlay" ng-class="{active: showMap}">
            <div class="map-header">
                <div class="map-title">
                    <i class="fas fa-map-marked-alt"></i> Mumbai Suburban Network
                </div>
                <div class="close-map-btn" ng-click="toggleMap(false)">CLOSE MAP ✕</div>
            </div>
            <!-- Schematic Map Container -->
            <div class="map-diagram">

                <!-- Western Railway -->
                <div class="rail-line-col line-wr">
                    <div class="rail-line-label">Western</div>
                    <div class="track-line"></div>
                    <div class="map-station-node" ng-repeat="s in railwayData['Western Railway']"
                        ng-click="selectFromMap('Western Railway', s)"
                        ng-class="{'interchange': ['Dadar','Mumbai Central','Andheri','Borivali'].includes(s.name)}">
                        <div class="map-station-name">{{s.name}}</div>
                    </div>
                </div>

                <!-- Central Railway -->
                <div class="rail-line-col line-cr">
                    <div class="rail-line-label">Central</div>
                    <div class="track-line"></div>
                    <div class="map-station-node" ng-repeat="s in railwayData['Central Railway']"
                        ng-click="selectFromMap('Central Railway', s)"
                        ng-class="{'interchange': ['Dadar','Kurla','Thane','Mumbai CSMT','Kalyan'].includes(s.name)}">
                        <div class="map-station-name">{{s.name}}</div>
                    </div>
                </div>

                <!-- Harbour Line -->
                <div class="rail-line-col line-hr">
                    <div class="rail-line-label">Harbour</div>
                    <div class="track-line"></div>
                    <div class="map-station-node" ng-repeat="s in railwayData['Harbour Line']"
                        ng-click="selectFromMap('Harbour Line', s)"
                        ng-class="{'interchange': ['Kurla','Vadala Road','Panvel','Mumbai CSMT'].includes(s.name)}">
                        <div class="map-station-name">{{s.name}}</div>
                    </div>
                </div>

                <!-- Trans-Harbour Line -->
                <div class="rail-line-col line-th">
                    <div class="rail-line-label">Trans-Harbour</div>
                    <div class="track-line"></div>
                    <div class="map-station-node" ng-repeat="s in railwayData['Trans-Harbour Line']"
                        ng-click="selectFromMap('Trans-Harbour Line', s)"
                        ng-class="{'interchange': ['Thane','Vashi','Panvel','Nerul'].includes(s.name)}">
                        <div class="map-station-name">{{s.name}}</div>
                    </div>
                </div>

            </div>
        </div>

        <div class="main-panel">
            <!-- Sidebar: Station Navigator -->
            <div class="side-panel">
                <div class="side-header">
                    <h3>MUMBAI RAIL</h3>
                    <p>Select Route</p>
                </div>

                <div class="line-selector">
                    <div class="line-card wr" ng-class="{active: currentLine == 'Western Railway'}"
                        ng-click="setLine('Western Railway')">
                        <div class="line-info">
                            <span class="line-name">Western</span>
                            <span class="line-route">Churchgate ⇄ Dahanu</span>
                        </div>
                    </div>
                    <div class="line-card cr" ng-class="{active: currentLine == 'Central Railway'}"
                        ng-click="setLine('Central Railway')">
                        <div class="line-info">
                            <span class="line-name">Central</span>
                            <span class="line-route">CSMT ⇄ Kasara/Khopoli</span>
                        </div>
                    </div>
                    <div class="line-card hb" ng-class="{active: currentLine == 'Harbour Line'}"
                        ng-click="setLine('Harbour Line')">
                        <div class="line-info">
                            <span class="line-name">Harbour</span>
                            <span class="line-route">CSMT ⇄ Panvel/Goregaon</span>
                        </div>
                    </div>
                    <div class="line-card th" ng-class="{active: currentLine == 'Trans-Harbour'}"
                        ng-click="setLine('Trans-Harbour')">
                        <div class="line-info">
                            <span class="line-name">Trans-Harbour</span>
                            <span class="line-route">Thane ⇄ Vashi/Panvel</span>
                        </div>
                    </div>
                </div>

                <div class="search-container">
                    <input type="text" class="search-input" placeholder="Search station / शोध..." ng-model="searchText">
                    <i class="fas fa-search search-icon"></i>
                </div>

                <div class="station-list">
                    <div class="station-item" ng-repeat="station in getFilteredStations()"
                        ng-class="{active: (selectionMode == 'source' && sourceStation == station) || (selectionMode == 'destination' && destinationStation == station)}"
                        ng-click="selectStation(station)">
                        <div class="station-sign">
                            <div class="diamond"></div>
                            <div class="circle"></div>
                            <div class="bar">{{station.name}}</div>
                        </div>
                        <div class="names">
                            <span class="en">{{station.name}}</span>
                            <span class="hi">{{station.devng}}</span>
                        </div>
                        <i class="fas fa-chevron-right" style="opacity: 0.2; font-size: 12px; margin-left: auto;"></i>
                    </div>
                </div>
            </div>

            <!-- Main Dashboard -->
            <div class="main-interface">
                <div class="dash-header">
                    <div class="header-left">
                        <h2>TICKET DASHBOARD</h2>
                    </div>
                    <div class="header-right">
                        <!-- LED Map Button (Restored & Resized) -->
                        <div class="map-header-img-wrapper" ng-click="toggleMap(true)">
                            <img src="images/led_map_btn.png" alt="View Map" class="map-header-img">
                        </div>

                        <div class="mode-selector">
                            <div class="mode-btn" ng-class="{active: selectionMode == 'source'}"
                                ng-click="setSelectionMode('source')">SET SOURCE</div>
                            <div class="mode-btn" ng-class="{active: selectionMode == 'destination'}"
                                ng-click="setSelectionMode('destination')">SET DEST</div>
                        </div>
                    </div>
                </div>

                <div class="ticket-canvas">
                    <div class="ticket">
                        <div class="ticket-header">
                            <img src="images/mumbai_modern_monogram_logo.png" class="ticket-logo">
                            <div class="railway-label">
                                <h3>{{currentLine}}</h3>
                                <p>Unreserved Ticketing System</p>
                            </div>
                        </div>

                        <div class="ticket-body" style="padding: 0; flex: 1;">
                            <div class="route-row">
                                <div class="route-point">
                                    <div class="label">Source</div>
                                    <div class="station-sign large">
                                        <div class="diamond"></div>
                                        <div class="circle"></div>
                                        <div class="bar">{{sourceStation.name}}</div>
                                    </div>
                                    <div class="city-name">{{sourceStation.name}}</div>
                                </div>
                                <div class="route-point">
                                    <div class="label">Destination</div>
                                    <div class="station-sign large">
                                        <div class="diamond"></div>
                                        <div class="circle"></div>
                                        <div class="bar">{{destinationStation.name}}</div>
                                    </div>
                                    <div class="city-name">{{destinationStation.name}}</div>
                                </div>
                            </div>

                            <div class="ticket-controls">
                                <div class="ticket-footer">
                                    <div class="fare-block">
                                        <h4
                                            style="margin: 0; font-size: 11px; font-weight: 900; color: #8e8e93; text-transform: uppercase; letter-spacing: 1px;">
                                            Total Fare / एकूण भाडे</h4>
                                        <div class="price">₹ {{calculateFare()}}</div>
                                    </div>
                                    <button class="print-btn" onclick="window.print()"><i class="fas fa-print"
                                            style="margin-right: 10px;"></i> PRINT TICKET</button>
                                </div>
                            </div>
                        </div>
                        <h4
                            style="margin: 0; font-size: 11px; font-weight: 900; color: #8e8e93; text-transform: uppercase; letter-spacing: 1px;">
                            Total Fare / एकूण भाडे</h4>
                        <div class="price">₹ {{calculateFare()}}</div>
                    </div>
                    <!-- Duplicate Button Removed -->
                </div>
            </div>
        </div>
    </div>
    </div>
    </div>
    </div>

    <!-- Creative Footer (Moved to Root for Full Width) -->
    <div class="attribution">
        <div class="copyright-text">2022 &copy; All Rights Reserved</div>
        <span class="footer-pipe">|</span>
        <div class="dev-route">
            <span class="dev-label">DESIGNED & DEVELOPED BY</span>

            <a href="https://github.com/Amey-Thakur" target="_blank" class="station-link amey-link">
                <div class="dev-station">
                    <div class="station-dot wr-dot"></div>
                    <span class="station-name">Amey Thakur</span>
                </div>
            </a>

            <div class="route-line-connector">
                <div class="line-segment"></div>
                <i class="fas fa-train" style="font-size: 10px; color: #555;"></i>
                <div class="line-segment"></div>
            </div>

            <a href="https://github.com/msatmod" target="_blank" class="station-link mega-link">
                <div class="dev-station">
                    <div class="station-dot cr-dot"></div>
                    <span class="station-name">Mega Satish</span>
                </div>
            </a>
        </div>
    </div>

    <!-- Core Scripts -->
    <script src="js/jquery-1.11.0.min.js"></script>
    <script src="js/angular.min.js"></script>
    <script src="js/atvm-controller.js"></script>
</body>

</html>
<!DOCTYPE html>
<html lang="en" ng-app>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MUMBAI RAILWAY | ATVM</title>
    <link rel="icon" type="image/png" href="images/mumbai_modern_monogram_logo.png">

    <!-- Premium Assets -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- Core Styles -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/modules/themes.css" rel="stylesheet">
    <link href="css/modules/components.css" rel="stylesheet">
    <link href="css/modules/layout.css" rel="stylesheet">
    <link href="css/modules/map.css" rel="stylesheet">
    <link href="css/atvm.css" rel="stylesheet">
</head>

<body ng-controller="atvmController">
    <!-- Premium Loading Screen -->
    <div class="premium-loader">
        <img src="images/mumbai_modern_monogram_logo.png"
            style="width: 80px; filter: drop-shadow(0 4px 10px rgba(0,0,0,0.1)); opacity: 1;">
        <div class="loader-bar">
            <div class="loader-fill"></div>
        </div>
        <p style="font-size: 11px; text-transform: uppercase; letter-spacing: 2px; color: #8e8e93;">Initializing Mumbai
            Rail Network...</p>
    </div>

    <!-- Script to trigger load finish -->
    <script>
        window.addEventListener('load', function () {
            setTimeout(function () {
                document.body.classList.add('loaded');
            }, 1500);
        });
    </script>

    <div class="main-container">
        <!-- Interactive Map Overlay -->
        <div class="map-overlay" ng-class="{active: showMap}">
            <div class="map-header">
                <div class="map-title">
                    <i class="fas fa-map-marked-alt"></i> Mumbai Suburban Network
                </div>
                <div class="close-map-btn" ng-click="toggleMap(false)">CLOSE MAP ‚úï</div>
            </div>
            <!-- Schematic Map Container -->
            <div class="map-diagram">

                <!-- Western Railway -->
                <div class="rail-line-col line-wr">
                    <div class="rail-line-label">Western</div>
                    <div class="track-line"></div>
                    <div class="map-station-node" ng-repeat="s in railwayData['Western Railway']"
                        ng-click="selectFromMap('Western Railway', s)"
                        ng-class="{'interchange': ['Dadar','Mumbai Central','Andheri','Borivali'].includes(s.name)}">
                        <div class="map-station-name">{{s.name}}</div>
                    </div>
                </div>

                <!-- Central Railway -->
                <div class="rail-line-col line-cr">
                    <div class="rail-line-label">Central</div>
                    <div class="track-line"></div>
                    <div class="map-station-node" ng-repeat="s in railwayData['Central Railway']"
                        ng-click="selectFromMap('Central Railway', s)"
                        ng-class="{'interchange': ['Dadar','Kurla','Thane','Mumbai CSMT','Kalyan'].includes(s.name)}">
                        <div class="map-station-name">{{s.name}}</div>
                    </div>
                </div>

                <!-- Harbour Line -->
                <div class="rail-line-col line-hr">
                    <div class="rail-line-label">Harbour</div>
                    <div class="track-line"></div>
                    <div class="map-station-node" ng-repeat="s in railwayData['Harbour Line']"
                        ng-click="selectFromMap('Harbour Line', s)"
                        ng-class="{'interchange': ['Kurla','Vadala Road','Panvel','Mumbai CSMT'].includes(s.name)}">
                        <div class="map-station-name">{{s.name}}</div>
                    </div>
                </div>

                <!-- Trans-Harbour Line -->
                <div class="rail-line-col line-th">
                    <div class="rail-line-label">Trans-Harbour</div>
                    <div class="track-line"></div>
                    <div class="map-station-node" ng-repeat="s in railwayData['Trans-Harbour Line']"
                        ng-click="selectFromMap('Trans-Harbour Line', s)"
                        ng-class="{'interchange': ['Thane','Vashi','Panvel','Nerul'].includes(s.name)}">
                        <div class="map-station-name">{{s.name}}</div>
                    </div>
                </div>

            </div>
        </div>

        <div class="main-panel">
            <!-- Sidebar: Station Navigator -->
            <div class="side-panel">
                <div class="side-header" style="text-align: center; padding: 15px 0 5px 0;">
                    <h3 style="margin-bottom: 5px; line-height: 1.4;">
                        MUMBAI SUBURBAN RAILWAY<br>
                        <span style="font-size: 0.85em; opacity: 0.9;">‡§Æ‡•Å‡§Ç‡§¨‡§à ‡§â‡§™‡§®‡§ó‡§∞‡•Ä‡§Ø ‡§∞‡•á‡§≤‡•ç‡§µ‡•á</span>
                    </h3>
                    <p style="font-size: 11px; color: #888; font-weight: 600; letter-spacing: 0.5px; margin: 0;">
                        SELECT YOUR ROUTE / ‡§§‡•Å‡§Æ‡§ö‡§æ ‡§Æ‡§æ‡§∞‡•ç‡§ó ‡§®‡§ø‡§µ‡§°‡§æ
                    </p>
                </div>

                <div class="line-selector">
                    <div class="line-card wr" ng-class="{active: currentLine == 'Western Railway'}"
                        ng-click="setLine('Western Railway')">
                        <div class="line-info">
                            <span class="line-name">WESTERN / ‡§™‡§∂‡•ç‡§ö‡§ø‡§Æ</span>
                            <span class="line-route">Churchgate ‚áÑ Dahanu</span>
                        </div>
                    </div>
                    <div class="line-card cr" ng-class="{active: currentLine == 'Central Railway'}"
                        ng-click="setLine('Central Railway')">
                        <div class="line-info">
                            <span class="line-name">CENTRAL / ‡§Æ‡§ß‡•ç‡§Ø</span>
                            <span class="line-route">CSMT ‚áÑ Kasara/Khopoli</span>
                        </div>
                    </div>
                    <div class="line-card hb" ng-class="{active: currentLine == 'Harbour Line'}"
                        ng-click="setLine('Harbour Line')">
                        <div class="line-info">
                            <span class="line-name">HARBOUR / ‡§π‡§æ‡§∞‡•ç‡§¨‡§∞</span>
                            <span class="line-route">CSMT ‚áÑ Panvel/Goregaon</span>
                        </div>
                    </div>
                    <div class="line-card th" ng-class="{active: currentLine == 'Trans-Harbour Line'}"
                        ng-click="setLine('Trans-Harbour Line')">
                        <div class="line-info">
                            <span class="line-name" style="font-size: 14px;">TRANS-HARBOUR / ‡§ü‡•ç‡§∞‡§æ‡§®‡•ç‡§∏-‡§π‡§æ‡§∞‡•ç‡§¨‡§∞</span>
                            <span class="line-route">Thane ‚áÑ Vashi/Panvel</span>
                        </div>
                    </div>
                </div>

                <!-- Mode Selector (Relocated for Accessibility) -->
                <div class="mode-selector" ng-class="{'mode-dest': selectionMode == 'destination'}">
                    <div class="glider"></div>
                    <div class="mode-btn" ng-class="{active: selectionMode == 'source'}"
                        ng-click="setSelectionMode('source')">SOURCE / ‡§â‡§ó‡§Æ</div>
                    <div class="mode-btn" ng-class="{active: selectionMode == 'destination'}"
                        ng-click="setSelectionMode('destination')">DESTINATION / ‡§ó‡§Ç‡§§‡§µ‡•ç‡§Ø</div>
                </div>

                <div class="search-container">
                    <input type="text" class="search-input" placeholder="Search Station / ‡§∏‡•ç‡§•‡§æ‡§®‡§ï ‡§∂‡•ã‡§ß‡§æ..."
                        ng-model="searchText" ng-keydown="$event.keyCode === 13 && selectFirstResult()">
                    <i class="fas fa-search search-icon"></i>
                </div>

                <div class="station-list">
                    <div class="station-item" ng-repeat="station in getFilteredStations()"
                        ng-class="{active: (selectionMode == 'source' && sourceStation == station) || (selectionMode == 'destination' && destinationStation == station)}"
                        ng-click="selectStation(station)">
                        <div class="station-sign">
                            <div class="diamond"></div>
                            <div class="circle"></div>
                            <div class="bar">{{station.name}}</div>
                        </div>
                        <div class="names">
                            <span class="en">{{station.name}}</span>
                            <span class="hi">{{station.devng}}</span>
                        </div>
                        <i class="fas fa-chevron-right" style="opacity: 0.2; font-size: 12px; margin-left: auto;"></i>
                    </div>
                </div>
            </div>

            <!-- Main Dashboard -->
            <div class="main-interface">
                <!-- Floating LED Map Sign (CSS Animated) -->
                <div class="floating-map-btn" ng-click="toggleMap(true)" title="View System Map">
                    <div class="hanger-rods">
                        <div class="rod left"></div>
                        <div class="rod right"></div>
                    </div>
                    <div class="led-board">
                        <div class="led-screen">
                            <div class="led-text">VIEW MAP &nbsp;&nbsp;‚óè&nbsp;&nbsp; ‡§®‡§ï‡§æ‡§∂‡§æ ‡§™‡§π‡§æ &nbsp;&nbsp;‚óè&nbsp;&nbsp;
                                DEVELOPED BY AMEY & MEGA &nbsp;&nbsp;‚óè&nbsp;&nbsp; ‡§Ö‡§Æ‡•á‡§Ø ‡§Ü‡§£‡§ø ‡§Æ‡•á‡§ó‡§æ</div>
                        </div>
                    </div>
                </div>

                <div class="ticket-canvas">
                    <div class="ticket" ng-class="{'train-reverse': trainDirection === 'reverse'}">
                        <!-- Interactive Train Track -->
                        <div class="train-track-container" ng-click="toggleTrainDirection()">
                            <div class="train-vessel">
                                <div class="compartment">üöÜ</div>
                                <div class="compartment">üöÉ</div>
                                <div class="compartment">üöÉ</div>
                                <div class="compartment">üöÉ</div>
                                <div class="compartment">üöÉ</div>
                            </div>
                        </div>
                        <div class="ticket-header">
                            <img src="images/mumbai_modern_monogram_logo.png" class="ticket-logo">
                            <div class="railway-label">
                                <h3>{{currentLine}} <span
                                        style="font-size: 0.8em; font-weight: 400; opacity: 0.8;">{{getLineMr(currentLine)}}</span>
                                </h3>
                                <p>Unreserved Ticketing System / ‡§Ö‡§®‡§æ‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§§‡§ø‡§ï‡•Ä‡§ü ‡§™‡•ç‡§∞‡§£‡§æ‡§≤‡•Ä</p>
                            </div>
                        </div>

                        <div class="ticket-body">

                            <!-- Journey Type Selector (Segmented Control) -->
                            <div class="journey-type-control" ng-class="{'mode-return': journeyType === 'Return'}">
                                <div class="glider"></div>
                                <div class="segment-option" ng-class="{active: journeyType === 'Single'}"
                                    ng-click="setJourneyType('Single')">
                                    <div class="seg-label">SINGLE <span class="mr-label">‡§è‡§ï-‡§Æ‡§æ‡§∞‡•ç‡§ó‡•Ä</span></div>
                                    <div class="seg-sub">Single Journey</div>
                                </div>
                                <div class="segment-option" ng-class="{active: journeyType === 'Return'}"
                                    ng-click="setJourneyType('Return')">
                                    <div class="seg-label">RETURN <span class="mr-label">‡§™‡§∞‡§§‡•Ä‡§ö‡•á</span></div>
                                    <div class="seg-sub">Valid for 24 hours</div>
                                </div>
                            </div>

                            <!-- Route Visuals (Restored Station Signs) -->
                            <div class="route-visual-row">
                                <div class="route-point">
                                    <div class="label"
                                        style="font-size: 10px; color: #888; font-weight: 700; text-transform: uppercase; margin-bottom: 5px;">
                                        Source / ‡§â‡§ó‡§Æ</div>
                                    <div class="station-sign">
                                        <div class="diamond"></div>
                                        <div class="circle"></div>
                                        <div class="bar">{{sourceStation.name}}</div>
                                    </div>
                                </div>

                                <div class="route-arrow">
                                    <i class="fas fa-arrow-right" style="color: #ccc; font-size: 16px;"></i>
                                    <div class="journey-badge" style="font-size: 10px; margin-top: 5px;">{{journeyType
                                        === 'Return' ? 'RETURN' : 'SINGLE'}}</div>
                                </div>

                                <div class="route-point">
                                    <div class="label"
                                        style="font-size: 10px; color: #888; font-weight: 700; text-transform: uppercase; margin-bottom: 5px;">
                                        Destination / ‡§ó‡§Ç‡§§‡§µ‡•ç‡§Ø</div>
                                    <div class="station-sign">
                                        <div class="diamond"></div>
                                        <div class="circle"></div>
                                        <div class="bar">{{destinationStation.name}}</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Passenger Controls -->
                            <div class="passenger-controls-grid">
                                <div class="pax-control-card">
                                    <div class="pax-label">ADULT / ‡§™‡•ç‡§∞‡•å‡§¢</div>
                                    <div class="stepper">
                                        <button class="step-btn minus" ng-click="updatePassenger('adults', -1)"
                                            ng-disabled="adults <= 0 || (adults == 1 && children == 0)"><i
                                                class="fas fa-minus"></i></button>
                                        <span class="step-val">{{adults}}</span>
                                        <button class="step-btn plus" ng-click="updatePassenger('adults', 1)"
                                            ng-disabled="adults == 5"><i class="fas fa-plus"></i></button>
                                    </div>
                                </div>
                                <div class="pax-control-card">
                                    <div class="pax-label">CHILD / ‡§Æ‡•Å‡§≤‡•á</div>
                                    <div class="stepper">
                                        <button class="step-btn minus" ng-click="updatePassenger('children', -1)"
                                            ng-disabled="children <= 0"><i class="fas fa-minus"></i></button>
                                        <span class="step-val">{{children}}</span>
                                        <button class="step-btn plus" ng-click="updatePassenger('children', 1)"
                                            ng-disabled="children == 5"><i class="fas fa-plus"></i></button>
                                    </div>
                                </div>
                            </div>

                        </div> <!-- End of .ticket-body -->

                        <!-- Footer with Fare and Print Button -->
                        <div class="ticket-controls">
                            <div class="ticket-footer">
                                <div class="fare-block">
                                    <h4
                                        style="margin: 0; font-size: 11px; font-weight: 900; color: #8e8e93; text-transform: uppercase; letter-spacing: 1px;">
                                        Total Fare / ‡§è‡§ï‡•Ç‡§£ ‡§≠‡§æ‡§°‡•á</h4>
                                    <div class="price">Rs. {{calculateFare()}} / ‚Çπ {{calculateFare()}}</div>
                                </div>
                                <button class="print-btn" onclick="window.print()" style="margin-left: auto;"><i
                                        class="fas fa-print" style="margin-right: 10px;"></i> PRINT TICKET / ‡§§‡§ø‡§ï‡•Ä‡§ü
                                    ‡§õ‡§æ‡§™‡§æ</button>
                            </div>
                        </div>

                    </div> <!-- End of .ticket -->
                </div> <!-- End of .ticket-canvas -->
            </div>
            <!-- Duplicate Button Removed -->
        </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    </div>

    <!-- Creative Footer (Moved to Root for Full Width) -->
    <div class="attribution">
        <div class="copyright-text">2022 &copy; All Rights Reserved</div>
        <span class="footer-pipe">|</span>
        <div class="dev-route">
            <span class="dev-label">DESIGNED & DEVELOPED BY</span>

            <a href="https://github.com/Amey-Thakur" target="_blank" class="station-link amey-link">
                <div class="dev-station">
                    <div class="station-dot wr-dot"></div>
                    <span class="station-name">Amey Thakur</span>
                </div>
            </a>

            <div class="route-line-connector">
                <div class="line-segment"></div>
                <i class="fas fa-train" style="font-size: 10px; color: #555;"></i>
                <div class="line-segment"></div>
            </div>

            <a href="https://github.com/msatmod" target="_blank" class="station-link mega-link">
                <div class="dev-station">
                    <div class="station-dot cr-dot"></div>
                    <span class="station-name">Mega Satish</span>
                </div>
            </a>
        </div>
    </div>

    <!-- Core Scripts -->
    <script src="js/jquery-1.11.0.min.js"></script>
    <script src="js/angular.min.js"></script>
    <script src="js/atvm-controller.js?v=2.1"></script>
</body>

</html>